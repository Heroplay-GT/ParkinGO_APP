<ion-content class="clients-page" fullscreen="true">
  <div class="header">
    <h1>Clients</h1>
    <p>List of all registered users</p>
  </div>

  <!-- Search Bar -->
  <div class="search-container">
    <ion-searchbar placeholder="Search by name or email" [(ngModel)]="searchTerm" (ionInput)="applyFilters()">
    </ion-searchbar>
  </div>

  <!-- Filter Select -->
  <div class="filter-container">
    <ion-select interface="popover" [(ngModel)]="providerFilter" (ionChange)="applyFilters()"
      placeholder="Filter by provider">

      <ion-select-option value="all">All</ion-select-option>
      <ion-select-option value="email">Email</ion-select-option>
      <ion-select-option value="google">Google</ion-select-option>

    </ion-select>
  </div>

  <!-- REFRESH FLOATING BUTTON -->
  <button class="floating-refresh" (click)="refreshList()">
    <ion-icon name="refresh-outline"></ion-icon>
  </button>

  <div *ngIf="loading" class="loading">
    <ion-spinner name="crescent"></ion-spinner>
  </div>

  <div *ngIf="!loading && clients.length === 0" class="empty">
    <ion-icon name="alert-circle-outline"></ion-icon>
    <p>No clients found</p>
  </div>

  <div class="client-list" *ngIf="filteredClients.length > 0">
    <ion-card *ngFor="let client of filteredClients" class="client-card">

      <div class="avatar">
        <ion-icon name="person-circle-outline"></ion-icon>
      </div>

      <div class="info">
        <h2>{{ client.name }}</h2>
        <p><strong>Email:</strong> {{ client.email }}</p>
        <p><strong>Phone:</strong> {{ client.phoneNumber || 'N/A' }}</p>
      </div>

      <ion-button fill="outline" size="small" color="primary" (click)="openDetails(client)">
        Details
      </ion-button>


    </ion-card>
  </div>

  <!-- ===== USER DETAILS MODAL ===== -->
  <ion-modal [isOpen]="showDetails" (didDismiss)="closeDetails()">
    <ng-template>
      <ion-header>
        <ion-toolbar color="primary">
          <ion-title>User Details</ion-title>
          <ion-buttons slot="end">
            <ion-button (click)="closeDetails()">
              <ion-icon name="close-outline"></ion-icon>
            </ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>

      <ion-content class="ion-padding modal-content">

        <div class="details-box" *ngIf="selectedClient">

          <h2>{{ selectedClient.name }}</h2>
          <p><strong>Email:</strong> {{ selectedClient.email }}</p>
          <p><strong>Phone:</strong> {{ selectedClient.phoneNumber || 'N/A' }}</p>
          <p><strong>UID:</strong> {{ selectedClient.uid }}</p>
          <p><strong>Provider:</strong> {{ selectedClient.provider || 'email' }}</p>
          <p><strong>Created at:</strong> {{ selectedClient.createdAt?.toDate() | date:'medium' }}</p>

        </div>

      </ion-content>
    </ng-template>
  </ion-modal>


  <app-admin-submenu (navigate)="go($event)"></app-admin-submenu>

</ion-content>
